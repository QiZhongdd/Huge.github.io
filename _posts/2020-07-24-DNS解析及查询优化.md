---
layout: post
title: DNS解析
subtitle: DNS解析
date: 2020-07-24
author: Qi
header-img: img/404-bg.jpg
catalog: true
tags:
  - 计算机基础知识
---

# DNS简介

域名系统(Domain Name System,DNS)是Internet上解决网上机器命名的一种系统。就像拜访朋友要先知道别人家怎么走一样，Internet上当一台主机要访问另外一台主机时，必须首先获知其地址，TCP/IP中的IP地址是由四段以“.”分开的数字组成，记起来总是不如名字那么方便，所以，就采用了域名系统来管理名字和IP的对应关系。

# 域名的分级

- 跟域名
根域名有两种划分方式，一种互联网刚兴起时的按照行业性质划分的com，net等，一种是按国家划分的如cn，jp，等。

- 顶级域名(一级域名)
所谓的一级域就是在根域名服务器之间加“.”,例如baidu.com是一级域名

- 二级域名
二级域名就是一级域名之前加‘.’，例如www.baidu.com。

**总结：域名的分级判断可以根据有多少个"."判断，有多少个‘.’就是几级域名**

# DNS解析
DNS的解析采用的是分级策略，主要是以下几个步骤
- 当我们访问www.goole.com时，首先会访问DNS解析程序，如果DNS解析程序缓存里面有这个地址，那么会直接返回ip地址。
- 如果DNS解析程序中不存在，DNS解析程序会从自己的配置文件读取读取13个根域名服务器（Root server）的地址，向其中一台发送请求
- 根域名服务器接受到请求后，知道是.com这个顶级域名，就会向DNS服务器返回顶级域名所在的地址。
- DNS拿到顶级域名所在的地址后，会根据顶级域名所在地址的TLD服务器发起请求，TLD服务器接受到请求后，会根据.goole.com，返回.goole.com所在的地址。
- DNS拿到.goole.com的地址后，向所在地址的Name Server发起请求，NameServer会根据www.gooke.com找到对应的ip地址返回给DNS服务器
- DNS拿到NameServer返回的ip地址后，会返回给客户端，并将该ip地址缓存
![Image text](/img/WechatIMG155.png)

# DNS查询优化
用户输入URL以后，浏览器首先要查询域名（hostname）对应服务器的IP地址，一般需要耗费20-120毫秒时间。DNS查询完成之前，浏览器无法从服务器下载任何数据。
- 基于性能考虑，ISP、局域网、操作系统、浏览器都会有相应的DNS缓存机制。
- 减少不同的主机名可减少DNS查找，减少不同主机名的数量同时也减少了页面能够并行下载的组件数量，避免DNS查找削减了响应时间，而减少并行下载数量却增加了响应时间。原则是把组件分散在2到4个主机名下，这是同时减少DNS查找和允许高并发下载的折中方案。


